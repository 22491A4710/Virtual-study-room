<!-- Timer Buttons (Updated UI) -->
<div class="mt-4 flex flex-col gap-2">
  <p class="font-semibold">ğŸ“ Task: <span id="currentTask">None</span></p>
  <p class="font-semibold">â± Time Left: <span id="timerDisplay">00:00</span></p>

  <div class="flex justify-center gap-2 mt-2">
    <button onclick="startTimer()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
      â–¶ï¸ Start
    </button>
    <button onclick="pauseResumeTimer()" id="pauseBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded" disabled>
      â¸ Pause
    </button>
    <button onclick="resetTimer()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded" disabled>
      ğŸ” Reset
    </button>
  </div>
</div>

<script>
  const roomData = JSON.parse(localStorage.getItem("roomData"));

  if (!roomData) {
    alert("No room data found. Redirecting...");
    window.location.href = "homepage.html";
  }

  document.getElementById("room-type").textContent = `Room Type: ${roomData.type}`;
  document.getElementById("room-id").textContent = `Room ID: ${roomData.roomId}`;
  document.getElementById("creator-name").textContent = `Created by: ${roomData.creator}`;

  if (roomData.type === "Multi User" && roomData.participants?.length > 0) {
    document.getElementById("participant-section").classList.remove("hidden");
    const list = document.getElementById("participants-list");
    roomData.participants.forEach((p) => {
      const li = document.createElement("li");
      li.textContent = p;
      list.appendChild(li);
    });
  }

  if (roomData.type === "Single User") {
    document.getElementById("single-user-tools").classList.remove("hidden");
  }

  function goHome() {
    window.location.href = "homepage.html";
  }

  // Timer Variables
  let countdown;
  let secondsLeft = 0;
  let isPaused = false;

  function startTimer() {
    const task = document.getElementById("taskInput").value;
    const minutes = parseInt(document.getElementById("timerInput").value);

    if (!task || isNaN(minutes) || minutes <= 0) {
      alert("Please enter a valid task and timer.");
      return;
    }

    document.getElementById("currentTask").textContent = task;
    secondsLeft = minutes * 60;
    updateTimerDisplay();

    clearInterval(countdown);
    isPaused = false;

    countdown = setInterval(() => {
      if (!isPaused) {
        secondsLeft--;
        updateTimerDisplay();

        if (secondsLeft <= 0) {
          clearInterval(countdown);
          document.getElementById("pauseBtn").disabled = true;
          alert("â° Task time is over!");
        }
      }
    }, 1000);

    // Enable pause and reset
    document.getElementById("pauseBtn").disabled = false;
    document.querySelector('[onclick="resetTimer()"]').disabled = false;
  }

  function updateTimerDisplay() {
    const m = String(Math.floor(secondsLeft / 60)).padStart(2, '0');
    const s = String(secondsLeft % 60).padStart(2, '0');
    document.getElementById("timerDisplay").textContent = `${m}:${s}`;
  }

  function pauseResumeTimer() {
    isPaused = !isPaused;
    const btn = document.getElementById("pauseBtn");
    btn.textContent = isPaused ? "â–¶ï¸ Resume" : "â¸ Pause";
  }

  function resetTimer() {
    clearInterval(countdown);
    secondsLeft = 0;
    updateTimerDisplay();
    isPaused = false;
    document.getElementById("currentTask").textContent = "None";
    document.getElementById("pauseBtn").textContent = "â¸ Pause";
    document.getElementById("pauseBtn").disabled = true;
    document.querySelector('[onclick="resetTimer()"]').disabled = true;
  }
</script>
